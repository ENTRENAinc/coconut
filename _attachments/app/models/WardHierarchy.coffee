class WardHierarchy

# ward_shehia_breakdown_by_constituan_district_region

#        "REGION": {
#            "DISTRICT": {
#                "CONSTITUAN": [
#                    "WARD/ Shehia"
#                ]
#            }
#        },

  WardHierarchy.hierarchy = {
      "URBAN WEST": {
          "URBAN": {
              "CHUMBUNI": [
                  "CHUMBUNI",
                  "KARAKANA",
                  "MUEMBE MAKUMBI"
              ],
              "KWAHANI": [
                  "KIDONGO CHEKUNDU",
                  "KWAALAMSHA",
                  "KWAHANI",
                  "MIKUNGUNI",
                  "MUUNGANO"
              ],
              "AMANI": [
                  "AMANI",
                  "KILIMAHEWA BONDENI",
                  "KILIMAHEWA JUU",
                  "SEBLENI"
              ],
              "MJI MKONGWE": [
                  "KIPONDA",
                  "MALINDI",
                  "MCHANGANI",
                  "MKUNAZINI",
                  "MWEMBETANGA",
                  "SHANGANI",
                  "VIKOKOTONI"
              ],
              "RAHA LEO": [
                  "GULIONI",
                  "MAKADARA",
                  "MLANDEGE",
                  "MUEMBE LADU",
                  "MWEMBESHAURI",
                  "RAHALEO"
              ],
              "KIKWAJUNI": [
                  "KIKWAJUNI BONDENI",
                  "KIKWAJUNI JUU",
                  "KILIMANI",
                  "KISIMA MAJONGOO",
                  "MIEMBENI"
              ],
              "JANG'OMBE": [
                  "JANG'OMBE",
                  "KWAALINATOO",
                  "MATARUMBETA",
                  "URUSI"
              ],
              "MPENDAE": [
                  "MEYA",
                  "MIGOMBANI",
                  "MPENDAE"
              ],
              "MAGOMENI": [
                  "KWA WAZEE",
                  "MAGOMENI",
                  "NYERERE",
                  "SOGEA"
              ],
              "KWAMTIPURA": [
                  "KWAMTIPURA",
                  "MKELE",
                  "SHAURIMOYO"
              ]
          },
          "WEST": {
              "MFENESINI": [
                  "CHUINI",
                  "KAMA",
                  "KIHINANI",
                  "MBUZINI",
                  "MFENESINI",
                  "MWAKAJE"
              ],
              "MAGOGONI": [
                  "KINUNI",
                  "MAGOGONI",
                  "WELEZO"
              ],
              "DOLE": [
                  "BUMBWISUDI",
                  "DOLE",
                  "KIANGA",
                  "KIZIMBANI",
                  "MTUFAANI",
                  "MWERA"
              ],
              "MWANAKWEREKWE": [
                  "MELINNE",
                  "MWANAKWEREKWE"
              ],
              "FUONI": [
                  "FUONI KIBONDENI",
                  "FUONI KIJITOUPELE",
                  "MAUNGANI",
                  "PANGAWE"
              ],
              "DIMANI": [
                  "BWELEO",
                  "DIMANI",
                  "FUMBA",
                  "KISAUNI",
                  "KOMBENI",
                  "MOMBASA",
                  "SHAKANI",
                  "TOMONDO"
              ],
              "MTONI": [
                  "KIDATU",
                  "MTONI",
                  "MTOPEPO"
              ],
              "BUBUBU": [
                  "BUBUBU",
                  "KIBWENI",
                  "MWANYANYA",
                  "SHARIFU MSA"
              ],
              "KIEMBESAMAKI": [
                  "CHUKWANI",
                  "KIEMBESAMAKI"
              ]
          }
      },
      "SOUTH PEMBA": {
          "MKOANI": {
              "MTAMBILE": [
                  "KANGANI",
                  "KENGEJA",
                  "MJIMBINI",
                  "MTAMBILE"
              ],
              "KIWANI": [
                  "KIWANI",
                  "MTANGANI",
                  "MWAMBE",
                  "SHAMIANI MWAMBE"
              ],
              "MKOANI": [
                  "CHUMBAGENI",
                  "MAKOMBENI",
                  "MAKOONGWE",
                  "MBUGUANI",
                  "NG'OMBENI",
                  "UWELENI",
                  "WAMBAA"
              ],
              "MKANYAGENI": [
                  "CHOKOCHO",
                  "KISIWA PANZA",
                  "MICHENZANI",
                  "MKANYAGENI",
                  "SHIDI"
              ],
              "CHAMBANI": [
                  "CHAMBANI",
                  "MIZINGANI",
                  "NGWACHANI",
                  "UKUTINI"
              ]
          },
          "CHAKECHAKE": {
              "ZIWANI": [
                  "KWALE",
                  "MBUZINI",
                  "NDAGONI",
                  "WARA",
                  "ZIWANI"
              ],
              "CHONGA": [
                  "CHONGA",
                  "DODO",
                  "KILINDI",
                  "MATALE",
                  "MGELEMA",
                  "NGOMENI",
                  "PUJINI"
              ],
              "CHAKECHAKE": [
                  "CHACHANI",
                  "CHANJAANI",
                  "SHUNGI",
                  "TIBIRINZI",
                  "WESHA"
              ],
              "WAWI": [
                  "MVUMONI",
                  "NG'AMBWA",
                  "UWANDANI",
                  "VITONGOJI",
                  "WAWI"
              ]
          }
      },
      "NORTH UNGUJA": {
          "NORTH B": {
              "DONGE": [
                  "DONGE KARANGE",
                  "DONGE KIPANGE",
                  "DONGE MBIJI",
                  "DONGE MCHANGANI",
                  "DONGE MNYIMBI",
                  "DONGE MTAMBILE",
                  "DONGE VIJIBWENI",
                  "MAHONDA",
                  "MUWANDA"
              ],
              "BUMBWINI": [
                  "KIDANZINI",
                  "MAFUFUNI",
                  "MAKOBA",
                  "MANGAPWANI",
                  "MISUFINI",
                  "ZINGWEZINGWE"
              ],
              "KITOPE": [
                  "FUJONI",
                  "KILOMBERO",
                  "KINDUNI",
                  "KIOMBA MVUA",
                  "KITOPE",
                  "KIWENGWA",
                  "MATETEMA",
                  "MBALENI",
                  "MGAMBO",
                  "MKADINI",
                  "PANGENI",
                  "UPENJA"
              ]
          },
          "NORTH A": {
              "CHAANI": [
                  "BANDAMAJI",
                  "CHAANI KUBWA",
                  "CHAANI MASINGINI",
                  "CHUTAMA",
                  "GAMBA",
                  "KINYASINI",
                  "KISONGONI",
                  "MCHENZASHAURI",
                  "MOGA"
              ],
              "TUMBATU": [
                  "MKOKOTONI",
                  "MTO WA PWANI",
                  "PALE",
                  "PITANAZAKO",
                  "TUMBATU GOMANI",
                  "TUMBATU JONGOWE"
              ],
              "MKWAJUNI": [
                  "KIBENI",
                  "KIVUNGE",
                  "MKWAJUNI",
                  "MUWANGE",
                  "POTOA"
              ],
              "NUNGWI": [
                  "FUKUCHANI",
                  "KIDOTI",
                  "KIGUNDA",
                  "KILIMANI",
                  "KILINDI",
                  "NUNGWI",
                  "TAZARI"
              ],
              "MATEMWE": [
                  "KANDWI",
                  "KIJINI",
                  "KIKOBWENI",
                  "MATEMWE",
                  "PWANI MCHANGANI"
              ]
          }
      },
      "SOUTH UNGUJA": {
          "SOUTH": {
              "MUYUNI": [
                  "BWEJUU",
                  "JAMBIANI KIBIGIJA",
                  "JAMBIANI KIKADINI",
                  "KITOGANI",
                  "MUUNGONI",
                  "MUYUNI A",
                  "MUYUNI B",
                  "MUYUNI C",
                  "PAJE",
                  "PETE"
              ],
              "MAKUNDUCHI": [
                  "KAJENGWA",
                  "KIBUTENI",
                  "KIJINI",
                  "KIZIMKAZI DIMBANI",
                  "KIZIMKAZI MKUNGUNI",
                  "MTENDE",
                  "MZURI",
                  "NGANANI"
              ]
          },
          "CENTRAL": {
              "UZINI": [
                  "BAMBI",
                  "GHANA",
                  "KIBOJE MKWAJUNI",
                  "KIBOJE MWEMBESHAURI",
                  "MCHANGANI",
                  "MGENI HAJI",
                  "MITAKAWANI",
                  "MIWANI",
                  "MPAPA",
                  "PAGALI",
                  "TUNDUNI",
                  "UMBUJI",
                  "UZINI"
              ],
              "KOANI": [
                  "BINGUNI",
                  "BUNGI",
                  "JUMBI",
                  "KIDIMNI",
                  "KIKUNGWI",
                  "KOANI",
                  "MACHUI",
                  "NG'AMBWA",
                  "TUNGUU",
                  "UBAGO",
                  "UNGUJA UKUU KAEBONA",
                  "UNGUJA UKUU KAEPWANI",
                  "UZI"
              ],
              "CHWAKA": [
                  "CHARAWE",
                  "CHEJU",
                  "CHWAKA",
                  "DUNGA BWENI",
                  "DUNGA KIEMBENI",
                  "JENDELE",
                  "MARUMBI",
                  "MICHAMVI",
                  "NDIJANI",
                  "PONGWE",
                  "UKONGORONI",
                  "UROA"
              ]
          }
      },
      "NORTH PEMBA": {
          "WETE": {
              "GANDO": [
                  "BOPWE",
                  "FUNDO",
                  "GANDO",
                  "KIZIMBANI",
                  "UKUNJWI"
              ],
              "WETE": [
                  "JADIDA",
                  "KIPANGANI",
                  "PANDANI",
                  "SELEMU",
                  "UTAANI"
              ],
              "MTAMBWE": [
                  "KISIWANI",
                  "MTAMBWE KASKAZINI",
                  "MTAMBWE KUSINI",
                  "PIKI"
              ],
              "KOJANI": [
                  "KIUNGONI",
                  "KOJANI",
                  "MCHANGAMDOGO",
                  "SHENGEJUU"
              ],
              "OLE": [
                  "KAMBINI",
                  "KANGAGANI",
                  "KIUYU MINUNGWINI",
                  "MJINI OLE",
                  "OLE"
              ]
          },
          "MICHEWENI": {
              "KONDE": [
                  "KIFUNDI/MATANGATWANI",
                  "KONDE",
                  "MAKANGALE",
                  "MSUKA"
              ],
              "TUMBE": [
                  "KINOWE",
                  "SHUMBA VIAMBONI",
                  "SIZINI",
                  "TUMBE"
              ],
              "MICHEWENI": [
                  "KIUYU MAZIWANG'OMBE",
                  "KIUYU MBUYUNI",
                  "MICHEWENI",
                  "MJINI WINGWI",
                  "SHUMBA MJINI"
              ],
              "MGOGONI": [
                  "FINYA",
                  "KINYASINI",
                  "MGOGONI",
                  "WINGWI MAPOFU",
                  "WINGWI MTEMANI",
                  "WINGWI NJUGUNI"
              ]
          }
      }
  }

  WardHierarchy.byWard = (targetWard) ->
    result = {}
    _.each WardHierarchy.hierarchy, (districts,region) ->
      _.each districts, (constituans,district) ->
        _.each constituans, (wards,constituan) ->
          _.each wards, (ward) ->
            if ward is targetWard
              result = {
                region: region
                district: district
                constituan: constituan
              }
    return result

  WardHierarchy.region = (ward) ->
    WardHierarchy.byWard(ward).region

  WardHierarchy.district = (ward) ->
    WardHierarchy.byWard(ward).district

  WardHierarchy.constituan = (ward) ->
    WardHierarchy.byWard(ward).constituan

  WardHierarchy.ward = (ward) ->
    ward

  WardHierarchy.allRegions = ->
    _.sortBy(_.keys(WardHierarchy.hierarchy), (region) -> region)

  WardHierarchy.allDistricts = ->
    _.chain(
      _.map WardHierarchy.hierarchy, (districts,region) ->
        _.keys districts
    )
    .flatten()
    .sortBy((district) -> district)
    .value()

  WardHierarchy.allConstituans = ->
    _.chain(
      _.map WardHierarchy.hierarchy, (districts,region) ->
        _.map districts, (constituans,district) ->
          _.keys constituans
    )
    .flatten()
    .sortBy((constituan) -> constituan)
    .value()

  WardHierarchy.allWards = (options) ->
    _.chain(
      _.map WardHierarchy.hierarchy, (districts,region) ->
        if options.region
          return unless region is options.region
        _.map districts, (constituans,district) ->
          if options.district
            return unless district is options.district
          _.map constituans, (wards,constituan) ->
            if options.constituan
              return unless constituan is options.constituan
            wards
    )
    .flatten()
    .compact()
    .sortBy((ward) -> ward)
    .value()
